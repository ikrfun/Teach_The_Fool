# 設計書: Teach the Fool — 教えて覚える学習アプリ
## "バカに教えて、自分が賢くなる"

---

## 1. コンセプト

**ラーニングピラミッドの「他者に教える（定着率90%）」をAIで実現する教育アプリ。**

ユーザーはまずAI先生から学び、その後「お馬鹿さん」キャラに教える側として説明する。
教え方が間違っていたり不十分だと、AI先生が割り込んで訂正する。
「インプット → アウトプット（教える） → フィードバック」のサイクルで記憶を定着させる。

### memUの活用ポイント
- ユーザーの学習履歴・理解度をmemUに記憶として蓄積
- 何を学んだか、何が曖昧だったか、いつ学んだかを記録
- 忘却曲線に基づいた復習タイミングの算出（将来機能）
- お馬鹿さんが「前に教えてもらったこと」を覚えている/忘れている

---

## 2. 3つのロール

### 🎓 AI先生（Teacher Agent）
- ユーザーが学びたい内容をリサーチし、わかりやすいテキストを生成
- お馬鹿さんとのチャット中、ユーザーの説明が間違っていたら訂正・補足
- 学習の進捗を評価

### 👤 ユーザー（Learner）
- まずAI先生から学ぶ（インプットフェーズ）
- 次にお馬鹿さんに教える（アウトプットフェーズ）
- 教えることで自分の理解の穴に気づく

### 🤪 お馬鹿さん（The Fool）
- 素朴な疑問を投げかけてくる（「なんで？」「それってどういうこと？」）
- 的外れな理解をして、ユーザーに訂正させる
- たまに鋭い質問をして、ユーザーの理解を試す
- 教えてもらったことを（memUで）覚えていて、成長を見せる

---

## 3. ユーザーフロー

```
[Step 1: トピック入力]
ユーザーが学びたい内容を入力（テキスト or キーワード）
例: 「量子コンピュータの基礎」「光合成の仕組み」

    ↓

[Step 2: AI先生の授業]（インプットフェーズ）
AI先生がリサーチ・整理した教材を提示
ユーザーは読んで学ぶ
質問があればAI先生に聞ける

    ↓

[Step 3: お馬鹿さんに教える]（アウトプットフェーズ）
チャットルームに切り替わる
お馬鹿さんが「ねぇ、○○って何？教えて！」と聞いてくる
ユーザーが自分の言葉で説明する
    - お馬鹿さん: 素朴な質問・的外れな理解で深掘り
    - AI先生: ユーザーの説明が間違っていたら割り込んで訂正
    - ユーザーが上手く教えられたらお馬鹿さんが「わかった！」と喜ぶ

    ↓

[Step 4: 学習レポート]
今回の学習内容のサマリー
理解度の評価（先生が判定）
memUに学習記録を保存
```

---

## 4. 画面構成

### 4.1 トピック入力画面
```
┌──────────────────────────────────┐
│  🎓 Teach the Fool               │
│  "教えて覚える学習アプリ"          │
│                                  │
│  何を学びたいですか？              │
│  ┌────────────────────────────┐  │
│  │ 量子コンピュータの基礎       │  │
│  └────────────────────────────┘  │
│  または                          │
│  [テキスト/PDF をアップロード]     │
│                                  │
│  [学習を始める →]                 │
└──────────────────────────────────┘
```

### 4.2 AI先生の授業画面
```
┌──────────────────────────────────┐
│  📖 先生の授業: 量子コンピュータ    │
├──────────────────────────────────┤
│                                  │
│  🎓 先生:                        │
│  「量子コンピュータとは...         │
│   ポイントは3つあります:          │
│   1. 量子ビット（キュービット）     │
│   2. 重ね合わせ                   │
│   3. 量子もつれ                   │
│   ...」                          │
│                                  │
│  ┌────────────────────────────┐  │
│  │ 先生に質問...        [質問] │  │
│  └────────────────────────────┘  │
│                                  │
│  [理解した！お馬鹿さんに教える →]  │
└──────────────────────────────────┘
```

### 4.3 お馬鹿さんに教えるチャット画面
```
┌──────────────────────────────────┐
│  💬 教室: 量子コンピュータ         │
│  🤪 お馬鹿さん  👤 あなた  🎓 先生 │
├──────────────────────────────────┤
│                                  │
│  🤪「ねぇねぇ、量子コンピュータ    │
│    ってなに？普通のパソコンと      │
│    何が違うの？」                  │
│                                  │
│  👤「えっとね、普通のコンピュータ   │
│    は0と1だけど、量子コンピュータ  │
│    は0と1を同時に...」            │
│                                  │
│  🤪「同時に？？どゆこと？」        │
│                                  │
│  👤「例えるならコインを回してる     │
│    状態で、表でも裏でもある...」   │
│                                  │
│  🎓「いい例えですね！補足すると    │
│    これを"重ね合わせ"と言います」  │
│                                  │
│  ┌────────────────────────────┐  │
│  │ お馬鹿さんに教える...  [送信] │  │
│  └────────────────────────────┘  │
└──────────────────────────────────┘
```

---

## 5. 技術構成

### フロントエンド
- **Next.js**
- 3画面: トピック入力 / 先生の授業 / 教えるチャット

### バックエンド
- **Node.js (Express)**
- エンドポイント:
  - `POST /api/topic` — トピック入力 → 先生が教材生成
  - `POST /api/teacher/chat` — 先生との質疑応答
  - `POST /api/teach/chat` — 教えるフェーズのチャット（お馬鹿さん応答 + 先生の訂正判定）
  - `GET /api/history` — 学習履歴取得
  - `POST /api/history` — 学習記録保存

### LLM
- **Grok (xAI API)** — OpenAI互換
- ベースURL: `https://api.x.ai/v1`
- 各ロールは別々のシステムプロンプトで制御

### メモリ層（memU — コアストレージとして全面活用）
- **全データをmemUで管理**（別途DBは持たない）
- （API仕様は別途確認）

#### memUに保管するデータ一覧

1. **チャットログ**
   - 先生↔ユーザーの質疑応答ログ
   - ユーザー↔お馬鹿さんの教えるフェーズのログ
   - 先生の訂正・介入ログ

2. **教材コンテンツ**
   - AI先生が生成した教材テキスト
   - トピックごとのキーコンセプト一覧

3. **ユーザーの学習記録**
   - 何を学んだか（トピック・日時）
   - 理解度スコア（先生の判定）
   - 正しく教えられた概念 / 間違えた概念
   - 学習回数・復習回数

4. **お馬鹿さん（生徒）の学習記録**
   - ユーザーから教わった内容
   - 理解できた概念 / まだわかってない概念
   - 過去に教わったことを覚えている（次回セッションで参照）

#### memUを使う利点
- 「前回○○を勉強したよね」とAI先生が自然に参照できる
- お馬鹿さんが「前に教えてもらった○○はわかったけど、△△がまだわかんない」と言える
- 学習履歴の検索・要約がmemUの機能でそのまま実現できる
- 忘却曲線対応の復習（将来機能）に必要なデータが自然に蓄積される

---

## 6. プロンプト設計（概要）

### AI先生のシステムプロンプト（教材生成時）
```
あなたは優秀な先生です。
ユーザーが入力したトピックについて、わかりやすく構造化された教材を作成してください。
- 核心となる概念を3-5個に整理
- 具体例や比喩を交えて説明
- 重要なポイントを明確に
```

### お馬鹿さんのシステムプロンプト
```
あなたは学習中の「お馬鹿さん」キャラクターです。
ユーザーが教えてくれる内容を理解しようとしますが:
- 素朴で的外れな質問をよくする
- 間違った理解をして、ユーザーに訂正のチャンスを与える
- たまに鋭い質問をして、ユーザーの理解を試す
- 教えてもらって理解できたら素直に喜ぶ
- フレンドリーでかわいい口調
```

### AI先生のシステムプロンプト（監視・訂正時）
```
あなたは先生として、ユーザーとお馬鹿さんの会話を監視しています。
以下の場合にのみ介入してください:
- ユーザーの説明に明らかな間違いがある場合 → 優しく訂正
- ユーザーの説明が不十分で重要な点が抜けている場合 → 補足
- ユーザーが上手く説明できた場合 → 褒める
介入が不要な場合は「NO_INTERVENTION」と返してください。
```

---

## 7. 教えるフェーズの処理フロー

```
[ユーザーがメッセージ送信]
    ↓
[Express API: POST /api/teach/chat]
    ↓
[並行処理]
  ├─ [1] お馬鹿さんの応答生成（Grok API）
  │    入力: お馬鹿さんプロンプト + 会話履歴 + ユーザーメッセージ
  │
  └─ [2] 先生の訂正判定（Grok API）
       入力: 先生（監視）プロンプト + 教材内容 + 会話履歴 + ユーザーメッセージ
    ↓
[応答組み立て]
  - お馬鹿さんの応答は必ず返す
  - 先生の応答は「NO_INTERVENTION」でなければ追加
    ↓
[フロントで表示]
  - お馬鹿さんの吹き出し
  - （あれば）先生の割り込み吹き出し
```

---

## 8. データ構造（すべてmemUに格納）

### 学習セッション
```json
{
  "type": "session",
  "id": "session_001",
  "topic": "量子コンピュータの基礎",
  "teacherMaterial": "（先生が生成した教材テキスト）",
  "keyConcepts": ["量子ビット", "重ね合わせ", "量子もつれ"],
  "createdAt": "2026-02-07T13:00:00Z",
  "status": "completed"
}
```

### チャットログ
```json
{
  "type": "chat_log",
  "sessionId": "session_001",
  "phase": "teaching",
  "messages": [
    { "role": "fool", "content": "量子コンピュータってなに？" },
    { "role": "user", "content": "普通のコンピュータは0と1だけど..." },
    { "role": "teacher", "content": "いい説明ですね！補足すると..." }
  ]
}
```

### ユーザーの学習記録
```json
{
  "type": "user_learning",
  "userId": "user_001",
  "topic": "量子コンピュータの基礎",
  "learnedAt": "2026-02-07T13:30:00Z",
  "conceptsUnderstood": ["量子ビット", "重ね合わせ"],
  "conceptsWeak": ["量子もつれ"],
  "comprehensionScore": 0.75,
  "teachingAccuracy": 0.8,
  "nextReviewDate": "2026-02-08T13:30:00Z"
}
```

### お馬鹿さん（生徒）の学習記録
```json
{
  "type": "fool_learning",
  "userId": "user_001",
  "topic": "量子コンピュータの基礎",
  "taughtAt": "2026-02-07T13:30:00Z",
  "understood": ["量子ビット"],
  "confused": ["重ね合わせ", "量子もつれ"],
  "memorableQuotes": ["コインを回してる状態ってこと？"]
}
```

---

## 9. MVPスコープ（ハッカソン内）

### 必須
- [ ] トピック入力 → AI先生が教材生成
- [ ] 先生の授業画面（テキスト表示 + 質疑応答）
- [ ] お馬鹿さんに教えるチャット画面（3者チャット）
- [ ] 先生の訂正介入機能
- [ ] memU統合: チャットログ・教材・学習記録を全てmemUに保存

### あれば嬉しい（時間があれば）
- [ ] 学習履歴の一覧表示
- [ ] お馬鹿さんが前回教わったことを覚えている
- [ ] 先生が過去の学習記録を参照して授業内容を調整

### 将来機能（ハッカソン外）
- [ ] 忘却曲線に基づいた復習リマインド
- [ ] お馬鹿さんが前回教えたことを覚えている/忘れている
- [ ] 理解度ダッシュボード
- [ ] テキスト/PDF アップロードからの教材自動生成

---

## 10. 環境変数

```env
XAI_API_KEY=your_grok_api_key
XAI_BASE_URL=https://api.x.ai/v1
XAI_MODEL=grok-3-latest
MEMU_API_KEY=（後で設定）
MEMU_API_URL=（後で設定）
```
